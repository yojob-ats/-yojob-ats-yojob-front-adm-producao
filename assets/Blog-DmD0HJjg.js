import{r as n,i as K,j as q,c as o,g as j,a as t,d as m,n as E,F as p,e as _,v as N,m as G,k as x,t as i,w as I,o as l,q as A}from"./index-Bht71nEJ.js";import{_ as Q}from"./SidebarRecruiter-BenWcOoe.js";import{b}from"./blog-C57kwh9U.js";import{t as D}from"./apiHelper-nSI_QOaT.js";import{_ as H}from"./_plugin-vue_export-helper-DlAUqK2U.js";const J={class:"layout-wrapper"},O={class:"main-content"},W={class:"container"},X={class:"page-header"},Y={class:"tabs"},Z={class:"filters"},tt={class:"card"},et={key:0,class:"loading-state"},at={key:1,class:"table-responsive"},st={class:"table"},ot={key:0},lt={class:"action-buttons"},nt=["onClick"],rt=["onClick","disabled"],it={key:1,class:"card section-card"},ut={class:"section-header"},dt={key:0,class:"inline-form"},ct={class:"inline-form-fields"},vt=["disabled"],mt={key:1,class:"loading-state"},bt={key:2,class:"table-responsive"},gt={class:"table"},yt={key:0},pt={key:0},ht=["onKeyup"],ft={class:"action-buttons"},Ct=["onClick"],wt=["onClick","disabled"],_t=["onClick","disabled"],kt={__name:"Blog",setup(St){const u=n("posts"),k=n(""),h=n(""),f=n([]),d=n([]),B=n(!0),S=n(!1),C=n(null),$=n(null),g=n(!1),c=n(!1),v=n(null),y=n(""),w=n({name:""});K(async()=>{try{const s=await b.list();f.value=D(s.data)}catch{window.showError("Erro ao carregar posts")}finally{B.value=!1}});async function R(){if(!(d.value.length>0)){S.value=!0;try{const s=await b.listCategories();d.value=D(s.data)}catch{window.showError("Erro ao carregar categorias")}finally{S.value=!1}}}async function L(s){if(confirm("Confirma a exclusão deste artigo?")){C.value=s;try{await b.delete(s),f.value=f.value.filter(e=>e.id!==s),window.showSuccess("Artigo removido com sucesso")}catch{window.showError("Erro ao remover artigo")}finally{C.value=null}}}async function M(){c.value=!0;try{const s=await b.createCategory(w.value);d.value.push(s.data),w.value={name:""},g.value=!1,window.showSuccess("Categoria criada com sucesso")}catch{window.showError("Erro ao criar categoria")}finally{c.value=!1}}function T(s){v.value=s.id,y.value=s.name}async function P(s){c.value=!0;try{await b.updateCategory(s.id,{name:y.value}),s.name=y.value,v.value=null,window.showSuccess("Categoria atualizada")}catch{window.showError("Erro ao atualizar categoria")}finally{c.value=!1}}async function U(s){if(confirm("Confirma a exclusão desta categoria?")){$.value=s;try{await b.deleteCategory(s),d.value=d.value.filter(e=>e.id!==s),window.showSuccess("Categoria removida")}catch{window.showError("Erro ao remover categoria")}finally{$.value=null}}}const V=q(()=>f.value.filter(s=>{var r;const e=(r=s.title)==null?void 0:r.toLowerCase().includes(k.value.toLowerCase()),a=!h.value||s.status===h.value;return e&&a})),z=s=>s?new Date(s).toLocaleDateString("pt-BR"):"—";return(s,e)=>(l(),o("div",J,[j(Q),t("main",O,[t("div",W,[t("header",X,[e[10]||(e[10]=t("div",null,[t("h1",null,"Blog"),t("p",null,"Gerencie artigos e categorias do blog")],-1)),u.value==="posts"?(l(),o("button",{key:0,onClick:e[0]||(e[0]=a=>s.$router.push("/blog/novo")),class:"btn btn-primary"},"+ Novo Artigo")):m("",!0)]),t("div",Y,[t("button",{onClick:e[1]||(e[1]=a=>u.value="posts"),class:E(["tab-btn",{active:u.value==="posts"}])},"Posts",2),t("button",{onClick:e[2]||(e[2]=a=>{u.value="categorias",R()}),class:E(["tab-btn",{active:u.value==="categorias"}])},"Categorias",2)]),u.value==="posts"?(l(),o(p,{key:0},[t("div",Z,[_(t("input",{"onUpdate:modelValue":e[3]||(e[3]=a=>k.value=a),type:"text",placeholder:"Buscar artigos...",class:"search-input"},null,512),[[N,k.value]]),_(t("select",{"onUpdate:modelValue":e[4]||(e[4]=a=>h.value=a),class:"select-input"},[...e[11]||(e[11]=[t("option",{value:""},"Todos os Status",-1),t("option",{value:"published"},"Publicado",-1),t("option",{value:"draft"},"Rascunho",-1)])],512),[[G,h.value]])]),t("div",tt,[B.value?(l(),o("div",et,"Carregando...")):(l(),o("div",at,[t("table",st,[e[13]||(e[13]=t("thead",null,[t("tr",null,[t("th",null,"Título"),t("th",null,"Autor"),t("th",null,"Categoria"),t("th",null,"Publicação"),t("th",null,"Status"),t("th",null,"Ações")])],-1)),t("tbody",null,[V.value.length===0?(l(),o("tr",ot,[...e[12]||(e[12]=[t("td",{colspan:"6",class:"empty-state"},"Nenhum artigo encontrado",-1)])])):m("",!0),(l(!0),o(p,null,x(V.value,a=>{var r;return l(),o("tr",{key:a.id},[t("td",null,i(a.title),1),t("td",null,i(a.author),1),t("td",null,i(((r=a.category)==null?void 0:r.name)??a.category??"—"),1),t("td",null,i(z(a.published_at??a.publishedDate)),1),t("td",null,[t("span",{class:E(["badge",`badge-${a.status}`])},i(a.status==="published"?"Publicado":"Rascunho"),3)]),t("td",lt,[t("button",{onClick:F=>s.$router.push(`/blog/editar/${a.id}`),class:"btn btn-sm btn-primary"},"Editar",8,nt),t("button",{onClick:F=>L(a.id),class:"btn btn-sm btn-danger",disabled:C.value===a.id},i(C.value===a.id?"...":"Remover"),9,rt)])])}),128))])])]))])],64)):m("",!0),u.value==="categorias"?(l(),o("div",it,[t("div",ut,[e[14]||(e[14]=t("h2",{class:"section-title"},"Categorias",-1)),t("button",{onClick:e[5]||(e[5]=a=>g.value=!g.value),class:"btn btn-sm btn-primary"},i(g.value?"Cancelar":"+ Nova Categoria"),1)]),g.value?(l(),o("div",dt,[t("form",{onSubmit:I(M,["prevent"])},[t("div",ct,[_(t("input",{"onUpdate:modelValue":e[6]||(e[6]=a=>w.value.name=a),class:"form-control",type:"text",placeholder:"Nome da categoria",required:""},null,512),[[N,w.value.name]]),t("button",{type:"submit",class:"btn btn-primary",disabled:c.value},i(c.value?"Salvando...":"Salvar"),9,vt)])],32)])):m("",!0),S.value?(l(),o("div",mt,"Carregando...")):(l(),o("div",bt,[t("table",gt,[e[16]||(e[16]=t("thead",null,[t("tr",null,[t("th",null,"Nome"),t("th",null,"Ações")])],-1)),t("tbody",null,[d.value.length===0?(l(),o("tr",yt,[...e[15]||(e[15]=[t("td",{colspan:"2",class:"empty-state"},"Nenhuma categoria cadastrada",-1)])])):m("",!0),(l(!0),o(p,null,x(d.value,a=>(l(),o("tr",{key:a.id},[t("td",null,[v.value!==a.id?(l(),o("span",pt,i(a.name),1)):_((l(),o("input",{key:1,"onUpdate:modelValue":e[7]||(e[7]=r=>y.value=r),class:"form-control form-control-inline",onKeyup:[A(r=>P(a),["enter"]),e[8]||(e[8]=A(r=>v.value=null,["esc"]))]},null,40,ht)),[[N,y.value]])]),t("td",ft,[v.value!==a.id?(l(),o(p,{key:0},[t("button",{onClick:r=>T(a),class:"btn btn-sm btn-secondary"},"Editar",8,Ct),t("button",{onClick:r=>U(a.id),class:"btn btn-sm btn-danger",disabled:$.value===a.id},"Remover",8,wt)],64)):(l(),o(p,{key:1},[t("button",{onClick:r=>P(a),class:"btn btn-sm btn-primary",disabled:c.value},"Salvar",8,_t),t("button",{onClick:e[9]||(e[9]=r=>v.value=null),class:"btn btn-sm btn-secondary"},"Cancelar")],64))])]))),128))])])]))])):m("",!0)])])]))}},Vt=H(kt,[["__scopeId","data-v-c6b99c77"]]);export{Vt as default};
