import{p as c,l as P,r as d,i as R,c as v,g as T,a as s,t as r,w as V,e as m,v as b,b as F,n as C,F as A,k as N,d as x,m as L,o as p}from"./index-Bht71nEJ.js";import{_ as J}from"./SidebarRecruiter-BenWcOoe.js";import{t as O}from"./apiHelper-nSI_QOaT.js";import{_ as G}from"./_plugin-vue_export-helper-DlAUqK2U.js";const f={getById:l=>c.get(`/admin/companies/${l}`),update:(l,n)=>c.put(`/admin/companies/${l}`,n),updateStatus:(l,n)=>c.put(`/admin/companies/${l}/status`,n),getUsers:l=>c.get(`/admin/companies/${l}/users`),addUser:(l,n)=>c.post(`/admin/companies/${l}/users`,n),updateUser:(l,n,i)=>c.put(`/admin/companies/${l}/users/${n}`,i),updateUserStatus:(l,n,i)=>c.put(`/admin/companies/${l}/users/${n}/status`,i),deleteUser:(l,n)=>c.delete(`/admin/companies/${l}/users/${n}`)},H={class:"layout-wrapper"},K={class:"main-content"},Q={class:"container"},W={class:"page-header"},X={class:"card section-card"},Y={class:"form-grid"},Z={class:"form-group"},ss={class:"form-group"},as={class:"form-group"},ts={class:"form-group"},es={class:"form-actions"},os=["disabled"],ls={class:"card section-card"},ns={class:"status-row"},is={class:"current-status"},rs={class:"status-buttons"},us=["onClick","disabled"],ds={class:"card section-card"},cs={class:"section-header"},vs={key:0,class:"add-user-form"},ms={class:"form-grid"},ps={class:"form-group"},bs={class:"form-group"},fs={class:"form-group"},ws={class:"form-group"},ys={class:"form-actions"},gs=["disabled"],Us={key:1,class:"loading-state"},_s={key:2,class:"table-responsive"},hs={class:"table"},Es={key:0},Ss={class:"action-buttons"},Cs=["onClick","disabled"],ks=["onClick","disabled"],$s={__name:"EditCompany",setup(l){const i=P().params.id,o=d({name:"",cnpj:"",email:"",phone:"",status:"active"}),w=d([]),_=d(!0),g=d(!1),h=d(!1),y=d(!1),U=d(!1),E=d(null),S=d(null),u=d({name:"",email:"",role:"recruiter",password:""}),q=[{value:"active",label:"Ativar",btnClass:"btn-success"},{value:"inactive",label:"Desativar",btnClass:"btn-secondary"},{value:"blocked",label:"Bloquear",btnClass:"btn-danger"}];R(async()=>{try{const e=await f.getById(i);o.value=e.data}catch{window.showError("Erro ao carregar empresa")}k()});async function k(){_.value=!0;try{const e=await f.getUsers(i);w.value=O(e.data)}catch{window.showError("Erro ao carregar usuários")}finally{_.value=!1}}async function z(){g.value=!0;try{await f.update(i,{name:o.value.name,cnpj:o.value.cnpj,email:o.value.email,phone:o.value.phone}),window.showSuccess("Empresa atualizada com sucesso")}catch{window.showError("Erro ao salvar empresa")}finally{g.value=!1}}async function B(e){h.value=!0;try{await f.updateStatus(i,{status:e}),o.value.status=e,window.showSuccess("Status atualizado com sucesso")}catch{window.showError("Erro ao atualizar status")}finally{h.value=!1}}async function D(){U.value=!0;try{await f.addUser(i,u.value),window.showSuccess("Usuário adicionado com sucesso"),y.value=!1,u.value={name:"",email:"",role:"recruiter",password:""},await k()}catch{window.showError("Erro ao adicionar usuário")}finally{U.value=!1}}async function j(e){E.value=e.id;const a=e.status==="active"?"inactive":"active";try{await f.updateUserStatus(i,e.id,{status:a}),e.status=a,window.showSuccess("Status do usuário atualizado")}catch{window.showError("Erro ao atualizar status do usuário")}finally{E.value=null}}async function I(e){if(confirm("Confirma a remoção deste usuário?")){S.value=e;try{await f.deleteUser(i,e),w.value=w.value.filter(a=>a.id!==e),window.showSuccess("Usuário removido com sucesso")}catch{window.showError("Erro ao remover usuário")}finally{S.value=null}}}const M=e=>({active:"Ativa",inactive:"Inativa",blocked:"Bloqueada"})[e]??e;return(e,a)=>(p(),v("div",H,[T(J),s("main",K,[s("div",Q,[s("header",W,[s("div",null,[s("h1",null,r(o.value.name||"Editar Empresa"),1),a[10]||(a[10]=s("p",null,"Dados e usuários da empresa",-1))]),s("button",{onClick:a[0]||(a[0]=t=>e.$router.push("/gestao-empresas")),class:"btn btn-secondary"}," ← Voltar ")]),s("div",X,[a[15]||(a[15]=s("h2",{class:"section-title"},"Dados da Empresa",-1)),s("form",{onSubmit:V(z,["prevent"])},[s("div",Y,[s("div",Z,[a[11]||(a[11]=s("label",null,"Nome da Empresa",-1)),m(s("input",{"onUpdate:modelValue":a[1]||(a[1]=t=>o.value.name=t),class:"form-control",type:"text",required:""},null,512),[[b,o.value.name]])]),s("div",ss,[a[12]||(a[12]=s("label",null,"CNPJ",-1)),m(s("input",{"onUpdate:modelValue":a[2]||(a[2]=t=>o.value.cnpj=t),class:"form-control",type:"text"},null,512),[[b,o.value.cnpj]])]),s("div",as,[a[13]||(a[13]=s("label",null,"Email",-1)),m(s("input",{"onUpdate:modelValue":a[3]||(a[3]=t=>o.value.email=t),class:"form-control",type:"email",required:""},null,512),[[b,o.value.email]])]),s("div",ts,[a[14]||(a[14]=s("label",null,"Telefone",-1)),m(s("input",{"onUpdate:modelValue":a[4]||(a[4]=t=>o.value.phone=t),class:"form-control",type:"text"},null,512),[[b,o.value.phone]])])]),s("div",es,[s("button",{type:"submit",class:"btn btn-primary",disabled:g.value},r(g.value?"Salvando...":"Salvar Dados"),9,os)])],32)]),s("div",ls,[a[17]||(a[17]=s("h2",{class:"section-title"},"Status da Empresa",-1)),s("div",ns,[s("span",is,[a[16]||(a[16]=F(" Status atual: ",-1)),s("span",{class:C(["badge",`badge-${o.value.status}`])},r(M(o.value.status)),3)]),s("div",rs,[(p(),v(A,null,N(q,t=>s("button",{key:t.value,onClick:$=>B(t.value),class:C(["btn","btn-sm",t.btnClass,{"btn-outline":o.value.status===t.value}]),disabled:o.value.status===t.value||h.value},r(t.label),11,us)),64))])])]),s("div",ds,[s("div",cs,[a[18]||(a[18]=s("h2",{class:"section-title"},"Usuários",-1)),s("button",{onClick:a[5]||(a[5]=t=>y.value=!y.value),class:"btn btn-sm btn-primary"},r(y.value?"Cancelar":"+ Adicionar Usuário"),1)]),y.value?(p(),v("div",vs,[s("form",{onSubmit:V(D,["prevent"])},[s("div",ms,[s("div",ps,[a[19]||(a[19]=s("label",null,"Nome",-1)),m(s("input",{"onUpdate:modelValue":a[6]||(a[6]=t=>u.value.name=t),class:"form-control",type:"text",required:""},null,512),[[b,u.value.name]])]),s("div",bs,[a[20]||(a[20]=s("label",null,"Email",-1)),m(s("input",{"onUpdate:modelValue":a[7]||(a[7]=t=>u.value.email=t),class:"form-control",type:"email",required:""},null,512),[[b,u.value.email]])]),s("div",fs,[a[22]||(a[22]=s("label",null,"Perfil",-1)),m(s("select",{"onUpdate:modelValue":a[8]||(a[8]=t=>u.value.role=t),class:"form-control"},[...a[21]||(a[21]=[s("option",{value:"admin"},"Admin",-1),s("option",{value:"recruiter"},"Recrutador",-1),s("option",{value:"viewer"},"Visualizador",-1)])],512),[[L,u.value.role]])]),s("div",ws,[a[23]||(a[23]=s("label",null,"Senha",-1)),m(s("input",{"onUpdate:modelValue":a[9]||(a[9]=t=>u.value.password=t),class:"form-control",type:"password",required:""},null,512),[[b,u.value.password]])])]),s("div",ys,[s("button",{type:"submit",class:"btn btn-primary",disabled:U.value},r(U.value?"Adicionando...":"Adicionar"),9,gs)])],32)])):x("",!0),_.value?(p(),v("div",Us,"Carregando usuários...")):(p(),v("div",_s,[s("table",hs,[a[25]||(a[25]=s("thead",null,[s("tr",null,[s("th",null,"Nome"),s("th",null,"Email"),s("th",null,"Perfil"),s("th",null,"Status"),s("th",null,"Ações")])],-1)),s("tbody",null,[w.value.length===0?(p(),v("tr",Es,[...a[24]||(a[24]=[s("td",{colspan:"5",class:"empty-state"},"Nenhum usuário cadastrado",-1)])])):x("",!0),(p(!0),v(A,null,N(w.value,t=>(p(),v("tr",{key:t.id},[s("td",null,r(t.name),1),s("td",null,r(t.email),1),s("td",null,r(t.role),1),s("td",null,[s("span",{class:C(["badge",t.status==="active"?"badge-active":"badge-inactive"])},r(t.status==="active"?"Ativo":"Inativo"),3)]),s("td",Ss,[s("button",{onClick:$=>j(t),class:"btn btn-sm btn-secondary",disabled:E.value===t.id},r(t.status==="active"?"Desativar":"Ativar"),9,Cs),s("button",{onClick:$=>I(t.id),class:"btn btn-sm btn-danger",disabled:S.value===t.id},"Remover",8,ks)])]))),128))])])]))])])])]))}},qs=G($s,[["__scopeId","data-v-58060bc3"]]);export{qs as default};
