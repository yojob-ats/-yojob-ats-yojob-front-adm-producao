import{l as D,r as i,i as N,c as e,g as A,a as t,d as c,t as o,F as _,k as h,o as s,n as g}from"./index-CBT-DF28.js";import{_ as L}from"./SidebarRecruiter-DDRAIM96.js";import{b as p}from"./billing-Db9NSHVk.js";import{_ as P}from"./_plugin-vue_export-helper-DlAUqK2U.js";const R={class:"layout-wrapper"},x={class:"main-content"},F={class:"container"},I={class:"page-header"},M={class:"tabs"},T=["onClick"],z={key:0,class:"card"},j={key:0,class:"loading-state"},q={key:1,class:"table-responsive"},G={class:"table"},H={key:0},J={key:1,class:"card"},K={key:0,class:"loading-state"},O={key:1,class:"table-responsive"},Q={class:"table"},U={key:0},W={key:2,class:"card"},X={key:0,class:"loading-state"},Y={key:1,class:"table-responsive"},Z={class:"table"},tt={key:0},at=["onClick","disabled"],et={key:1,class:"text-muted"},st={__name:"EditBilling",setup(nt){const d=D().params.id,E=i(null),b=i([]),k=i([]),f=i([]),u=i(!1),y=i(null),m=i("invoices"),B=[{key:"invoices",label:"Faturas"},{key:"payments",label:"Pagamentos"},{key:"subscriptions",label:"Assinaturas"}];N(async()=>{try{const l=await p.getCompany(d);E.value=l.data}catch{window.showError("Erro ao carregar empresa")}C("invoices")});async function C(l){var n,v,a;u.value=!0;try{if(l==="invoices"){const r=await p.getCompanyInvoices(d);b.value=((n=r.data)==null?void 0:n.data)??r.data??[]}else if(l==="payments"){const r=await p.getCompanyPayments(d);k.value=((v=r.data)==null?void 0:v.data)??r.data??[]}else if(l==="subscriptions"){const r=await p.getCompanySubscriptions(d);f.value=((a=r.data)==null?void 0:a.data)??r.data??[]}}catch{window.showError("Erro ao carregar dados")}finally{u.value=!1}}async function $(l){if(confirm("Confirma o cancelamento desta assinatura?")){y.value=l;try{await p.cancelSubscription(d,l),window.showSuccess("Assinatura cancelada com sucesso"),await C("subscriptions")}catch{window.showError("Erro ao cancelar assinatura")}finally{y.value=null}}}const w=l=>Number(l??0).toLocaleString("pt-BR",{style:"currency",currency:"BRL"}),S=l=>l?new Date(l).toLocaleDateString("pt-BR"):"—",V=l=>({paid:"Pago",pending:"Pendente",overdue:"Vencido",active:"Ativo",canceled:"Cancelado",completed:"Concluído"})[l]??l;return(l,n)=>{var v;return s(),e("div",R,[A(L),t("main",x,[t("div",F,[t("header",I,[t("div",null,[t("h1",null,o(((v=E.value)==null?void 0:v.name)??"Empresa"),1),n[1]||(n[1]=t("p",null,"Detalhe de faturamento",-1))]),t("button",{onClick:n[0]||(n[0]=a=>l.$router.push("/faturamento")),class:"btn btn-secondary"}," ← Voltar ")]),t("div",M,[(s(),e(_,null,h(B,a=>t("button",{key:a.key,onClick:r=>{m.value=a.key,C(a.key)},class:g(["tab-btn",{active:m.value===a.key}])},o(a.label),11,T)),64))]),m.value==="invoices"?(s(),e("div",z,[u.value?(s(),e("div",j,"Carregando...")):(s(),e("div",q,[t("table",G,[n[3]||(n[3]=t("thead",null,[t("tr",null,[t("th",null,"Referência"),t("th",null,"Valor"),t("th",null,"Vencimento"),t("th",null,"Status")])],-1)),t("tbody",null,[b.value.length===0?(s(),e("tr",H,[...n[2]||(n[2]=[t("td",{colspan:"4",class:"empty-state"},"Nenhuma fatura encontrada",-1)])])):c("",!0),(s(!0),e(_,null,h(b.value,a=>(s(),e("tr",{key:a.id},[t("td",null,o(a.reference),1),t("td",null,o(w(a.amount)),1),t("td",null,o(S(a.due_date)),1),t("td",null,[t("span",{class:g(["badge",`badge-${a.status}`])},o(V(a.status)),3)])]))),128))])])]))])):c("",!0),m.value==="payments"?(s(),e("div",J,[u.value?(s(),e("div",K,"Carregando...")):(s(),e("div",O,[t("table",Q,[n[5]||(n[5]=t("thead",null,[t("tr",null,[t("th",null,"Descrição"),t("th",null,"Valor"),t("th",null,"Data"),t("th",null,"Método"),t("th",null,"Status")])],-1)),t("tbody",null,[k.value.length===0?(s(),e("tr",U,[...n[4]||(n[4]=[t("td",{colspan:"5",class:"empty-state"},"Nenhum pagamento encontrado",-1)])])):c("",!0),(s(!0),e(_,null,h(k.value,a=>(s(),e("tr",{key:a.id},[t("td",null,o(a.description),1),t("td",null,o(w(a.amount)),1),t("td",null,o(S(a.paid_at??a.created_at)),1),t("td",null,o(a.method??"—"),1),t("td",null,[t("span",{class:g(["badge",`badge-${a.status}`])},o(V(a.status)),3)])]))),128))])])]))])):c("",!0),m.value==="subscriptions"?(s(),e("div",W,[u.value?(s(),e("div",X,"Carregando...")):(s(),e("div",Y,[t("table",Z,[n[7]||(n[7]=t("thead",null,[t("tr",null,[t("th",null,"Plano"),t("th",null,"Valor"),t("th",null,"Início"),t("th",null,"Status"),t("th",null,"Ações")])],-1)),t("tbody",null,[f.value.length===0?(s(),e("tr",tt,[...n[6]||(n[6]=[t("td",{colspan:"5",class:"empty-state"},"Nenhuma assinatura encontrada",-1)])])):c("",!0),(s(!0),e(_,null,h(f.value,a=>(s(),e("tr",{key:a.id},[t("td",null,o(a.plan),1),t("td",null,o(w(a.amount)),1),t("td",null,o(S(a.started_at)),1),t("td",null,[t("span",{class:g(["badge",`badge-${a.status}`])},o(a.status==="active"?"Ativa":"Cancelada"),3)]),t("td",null,[a.status==="active"?(s(),e("button",{key:0,onClick:r=>$(a.id),class:"btn btn-sm btn-danger",disabled:y.value===a.id},o(y.value===a.id?"Cancelando...":"Cancelar"),9,at)):(s(),e("span",et,"—"))])]))),128))])])]))])):c("",!0)])])])}}},dt=P(st,[["__scopeId","data-v-6b78fca9"]]);export{dt as default};
