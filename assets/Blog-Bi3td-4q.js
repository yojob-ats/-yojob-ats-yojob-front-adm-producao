import{r as n,i as F,j as K,c as o,g as q,a as t,d as b,n as E,F as f,e as _,v as N,m as j,k as x,t as i,w as G,o as l,q as D}from"./index-BW0SG1OL.js";import{_ as I}from"./SidebarRecruiter-CqvTDxCK.js";import{b as m}from"./blog-Bq-OHucs.js";import{_ as Q}from"./_plugin-vue_export-helper-DlAUqK2U.js";const H={class:"layout-wrapper"},J={class:"main-content"},O={class:"container"},W={class:"page-header"},X={class:"tabs"},Y={class:"filters"},Z={class:"card"},tt={key:0,class:"loading-state"},et={key:1,class:"table-responsive"},at={class:"table"},st={key:0},ot={class:"action-buttons"},lt=["onClick"],nt=["onClick","disabled"],rt={key:1,class:"card section-card"},it={class:"section-header"},ut={key:0,class:"inline-form"},dt={class:"inline-form-fields"},ct=["disabled"],vt={key:1,class:"loading-state"},bt={key:2,class:"table-responsive"},mt={class:"table"},gt={key:0},yt={key:0},ft=["onKeyup"],ht={class:"action-buttons"},pt=["onClick"],Ct=["onClick","disabled"],wt=["onClick","disabled"],_t={__name:"Blog",setup(kt){const u=n("posts"),k=n(""),h=n(""),p=n([]),d=n([]),B=n(!0),S=n(!1),C=n(null),$=n(null),g=n(!1),c=n(!1),v=n(null),y=n(""),w=n({name:""});F(async()=>{var s;try{const e=await m.list();p.value=((s=e.data)==null?void 0:s.data)??e.data??[]}catch{window.showError("Erro ao carregar posts")}finally{B.value=!1}});async function A(){var s;if(!(d.value.length>0)){S.value=!0;try{const e=await m.listCategories();d.value=((s=e.data)==null?void 0:s.data)??e.data??[]}catch{window.showError("Erro ao carregar categorias")}finally{S.value=!1}}}async function R(s){if(confirm("Confirma a exclusão deste artigo?")){C.value=s;try{await m.delete(s),p.value=p.value.filter(e=>e.id!==s),window.showSuccess("Artigo removido com sucesso")}catch{window.showError("Erro ao remover artigo")}finally{C.value=null}}}async function L(){c.value=!0;try{const s=await m.createCategory(w.value);d.value.push(s.data),w.value={name:""},g.value=!1,window.showSuccess("Categoria criada com sucesso")}catch{window.showError("Erro ao criar categoria")}finally{c.value=!1}}function M(s){v.value=s.id,y.value=s.name}async function P(s){c.value=!0;try{await m.updateCategory(s.id,{name:y.value}),s.name=y.value,v.value=null,window.showSuccess("Categoria atualizada")}catch{window.showError("Erro ao atualizar categoria")}finally{c.value=!1}}async function T(s){if(confirm("Confirma a exclusão desta categoria?")){$.value=s;try{await m.deleteCategory(s),d.value=d.value.filter(e=>e.id!==s),window.showSuccess("Categoria removida")}catch{window.showError("Erro ao remover categoria")}finally{$.value=null}}}const V=K(()=>p.value.filter(s=>{var r;const e=(r=s.title)==null?void 0:r.toLowerCase().includes(k.value.toLowerCase()),a=!h.value||s.status===h.value;return e&&a})),U=s=>s?new Date(s).toLocaleDateString("pt-BR"):"—";return(s,e)=>(l(),o("div",H,[q(I),t("main",J,[t("div",O,[t("header",W,[e[10]||(e[10]=t("div",null,[t("h1",null,"Blog"),t("p",null,"Gerencie artigos e categorias do blog")],-1)),u.value==="posts"?(l(),o("button",{key:0,onClick:e[0]||(e[0]=a=>s.$router.push("/blog/novo")),class:"btn btn-primary"},"+ Novo Artigo")):b("",!0)]),t("div",X,[t("button",{onClick:e[1]||(e[1]=a=>u.value="posts"),class:E(["tab-btn",{active:u.value==="posts"}])},"Posts",2),t("button",{onClick:e[2]||(e[2]=a=>{u.value="categorias",A()}),class:E(["tab-btn",{active:u.value==="categorias"}])},"Categorias",2)]),u.value==="posts"?(l(),o(f,{key:0},[t("div",Y,[_(t("input",{"onUpdate:modelValue":e[3]||(e[3]=a=>k.value=a),type:"text",placeholder:"Buscar artigos...",class:"search-input"},null,512),[[N,k.value]]),_(t("select",{"onUpdate:modelValue":e[4]||(e[4]=a=>h.value=a),class:"select-input"},[...e[11]||(e[11]=[t("option",{value:""},"Todos os Status",-1),t("option",{value:"published"},"Publicado",-1),t("option",{value:"draft"},"Rascunho",-1)])],512),[[j,h.value]])]),t("div",Z,[B.value?(l(),o("div",tt,"Carregando...")):(l(),o("div",et,[t("table",at,[e[13]||(e[13]=t("thead",null,[t("tr",null,[t("th",null,"Título"),t("th",null,"Autor"),t("th",null,"Categoria"),t("th",null,"Publicação"),t("th",null,"Status"),t("th",null,"Ações")])],-1)),t("tbody",null,[V.value.length===0?(l(),o("tr",st,[...e[12]||(e[12]=[t("td",{colspan:"6",class:"empty-state"},"Nenhum artigo encontrado",-1)])])):b("",!0),(l(!0),o(f,null,x(V.value,a=>{var r;return l(),o("tr",{key:a.id},[t("td",null,i(a.title),1),t("td",null,i(a.author),1),t("td",null,i(((r=a.category)==null?void 0:r.name)??a.category??"—"),1),t("td",null,i(U(a.published_at??a.publishedDate)),1),t("td",null,[t("span",{class:E(["badge",`badge-${a.status}`])},i(a.status==="published"?"Publicado":"Rascunho"),3)]),t("td",ot,[t("button",{onClick:z=>s.$router.push(`/blog/editar/${a.id}`),class:"btn btn-sm btn-primary"},"Editar",8,lt),t("button",{onClick:z=>R(a.id),class:"btn btn-sm btn-danger",disabled:C.value===a.id},i(C.value===a.id?"...":"Remover"),9,nt)])])}),128))])])]))])],64)):b("",!0),u.value==="categorias"?(l(),o("div",rt,[t("div",it,[e[14]||(e[14]=t("h2",{class:"section-title"},"Categorias",-1)),t("button",{onClick:e[5]||(e[5]=a=>g.value=!g.value),class:"btn btn-sm btn-primary"},i(g.value?"Cancelar":"+ Nova Categoria"),1)]),g.value?(l(),o("div",ut,[t("form",{onSubmit:G(L,["prevent"])},[t("div",dt,[_(t("input",{"onUpdate:modelValue":e[6]||(e[6]=a=>w.value.name=a),class:"form-control",type:"text",placeholder:"Nome da categoria",required:""},null,512),[[N,w.value.name]]),t("button",{type:"submit",class:"btn btn-primary",disabled:c.value},i(c.value?"Salvando...":"Salvar"),9,ct)])],32)])):b("",!0),S.value?(l(),o("div",vt,"Carregando...")):(l(),o("div",bt,[t("table",mt,[e[16]||(e[16]=t("thead",null,[t("tr",null,[t("th",null,"Nome"),t("th",null,"Ações")])],-1)),t("tbody",null,[d.value.length===0?(l(),o("tr",gt,[...e[15]||(e[15]=[t("td",{colspan:"2",class:"empty-state"},"Nenhuma categoria cadastrada",-1)])])):b("",!0),(l(!0),o(f,null,x(d.value,a=>(l(),o("tr",{key:a.id},[t("td",null,[v.value!==a.id?(l(),o("span",yt,i(a.name),1)):_((l(),o("input",{key:1,"onUpdate:modelValue":e[7]||(e[7]=r=>y.value=r),class:"form-control form-control-inline",onKeyup:[D(r=>P(a),["enter"]),e[8]||(e[8]=D(r=>v.value=null,["esc"]))]},null,40,ft)),[[N,y.value]])]),t("td",ht,[v.value!==a.id?(l(),o(f,{key:0},[t("button",{onClick:r=>M(a),class:"btn btn-sm btn-secondary"},"Editar",8,pt),t("button",{onClick:r=>T(a.id),class:"btn btn-sm btn-danger",disabled:$.value===a.id},"Remover",8,Ct)],64)):(l(),o(f,{key:1},[t("button",{onClick:r=>P(a),class:"btn btn-sm btn-primary",disabled:c.value},"Salvar",8,wt),t("button",{onClick:e[9]||(e[9]=r=>v.value=null),class:"btn btn-sm btn-secondary"},"Cancelar")],64))])]))),128))])])]))])):b("",!0)])])]))}},Bt=Q(_t,[["__scopeId","data-v-6f0c5cfd"]]);export{Bt as default};
