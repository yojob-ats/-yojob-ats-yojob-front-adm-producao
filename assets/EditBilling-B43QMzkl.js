import{l as N,r,i as A,c as s,g as L,a as t,d as i,t as o,F as p,k as y,o as n,n as _}from"./index-BQyMN7yE.js";import{_ as P}from"./SidebarRecruiter-Cjm4dI9A.js";import{b as m}from"./billing-CUF9lM6g.js";import{t as w}from"./apiHelper-CRUk9URl.js";import{_ as R}from"./_plugin-vue_export-helper-DlAUqK2U.js";const x={class:"layout-wrapper"},F={class:"main-content"},I={class:"container"},M={class:"page-header"},T={class:"tabs"},z=["onClick"],j={key:0,class:"card"},q={key:0,class:"loading-state"},G={key:1,class:"table-responsive"},H={class:"table"},J={key:0},K={key:1,class:"card"},O={key:0,class:"loading-state"},Q={key:1,class:"table-responsive"},U={class:"table"},W={key:0},X={key:2,class:"card"},Y={key:0,class:"loading-state"},Z={key:1,class:"table-responsive"},tt={class:"table"},at={key:0},et=["onClick","disabled"],st={key:1,class:"text-muted"},nt={__name:"EditBilling",setup(lt){const c=N().params.id,S=r(null),h=r([]),g=r([]),b=r([]),u=r(!1),v=r(null),d=r("invoices"),B=[{key:"invoices",label:"Faturas"},{key:"payments",label:"Pagamentos"},{key:"subscriptions",label:"Assinaturas"}];A(async()=>{try{const l=await m.getCompany(c);S.value=l.data}catch{window.showError("Erro ao carregar empresa")}k("invoices")});async function k(l){u.value=!0;try{if(l==="invoices"){const e=await m.getCompanyInvoices(c);h.value=w(e.data)}else if(l==="payments"){const e=await m.getCompanyPayments(c);g.value=w(e.data)}else if(l==="subscriptions"){const e=await m.getCompanySubscriptions(c);b.value=w(e.data)}}catch{window.showError("Erro ao carregar dados")}finally{u.value=!1}}async function $(l){if(confirm("Confirma o cancelamento desta assinatura?")){v.value=l;try{await m.cancelSubscription(c,l),window.showSuccess("Assinatura cancelada com sucesso"),await k("subscriptions")}catch{window.showError("Erro ao cancelar assinatura")}finally{v.value=null}}}const f=l=>Number(l??0).toLocaleString("pt-BR",{style:"currency",currency:"BRL"}),C=l=>l?new Date(l).toLocaleDateString("pt-BR"):"—",E=l=>({paid:"Pago",pending:"Pendente",overdue:"Vencido",active:"Ativo",canceled:"Cancelado",completed:"Concluído"})[l]??l;return(l,e)=>{var V;return n(),s("div",x,[L(P),t("main",F,[t("div",I,[t("header",M,[t("div",null,[t("h1",null,o(((V=S.value)==null?void 0:V.name)??"Empresa"),1),e[1]||(e[1]=t("p",null,"Detalhe de faturamento",-1))]),t("button",{onClick:e[0]||(e[0]=a=>l.$router.push("/faturamento")),class:"btn btn-secondary"}," ← Voltar ")]),t("div",T,[(n(),s(p,null,y(B,a=>t("button",{key:a.key,onClick:D=>{d.value=a.key,k(a.key)},class:_(["tab-btn",{active:d.value===a.key}])},o(a.label),11,z)),64))]),d.value==="invoices"?(n(),s("div",j,[u.value?(n(),s("div",q,"Carregando...")):(n(),s("div",G,[t("table",H,[e[3]||(e[3]=t("thead",null,[t("tr",null,[t("th",null,"Referência"),t("th",null,"Valor"),t("th",null,"Vencimento"),t("th",null,"Status")])],-1)),t("tbody",null,[h.value.length===0?(n(),s("tr",J,[...e[2]||(e[2]=[t("td",{colspan:"4",class:"empty-state"},"Nenhuma fatura encontrada",-1)])])):i("",!0),(n(!0),s(p,null,y(h.value,a=>(n(),s("tr",{key:a.id},[t("td",null,o(a.reference),1),t("td",null,o(f(a.amount)),1),t("td",null,o(C(a.due_date)),1),t("td",null,[t("span",{class:_(["badge",`badge-${a.status}`])},o(E(a.status)),3)])]))),128))])])]))])):i("",!0),d.value==="payments"?(n(),s("div",K,[u.value?(n(),s("div",O,"Carregando...")):(n(),s("div",Q,[t("table",U,[e[5]||(e[5]=t("thead",null,[t("tr",null,[t("th",null,"Descrição"),t("th",null,"Valor"),t("th",null,"Data"),t("th",null,"Método"),t("th",null,"Status")])],-1)),t("tbody",null,[g.value.length===0?(n(),s("tr",W,[...e[4]||(e[4]=[t("td",{colspan:"5",class:"empty-state"},"Nenhum pagamento encontrado",-1)])])):i("",!0),(n(!0),s(p,null,y(g.value,a=>(n(),s("tr",{key:a.id},[t("td",null,o(a.description),1),t("td",null,o(f(a.amount)),1),t("td",null,o(C(a.paid_at??a.created_at)),1),t("td",null,o(a.method??"—"),1),t("td",null,[t("span",{class:_(["badge",`badge-${a.status}`])},o(E(a.status)),3)])]))),128))])])]))])):i("",!0),d.value==="subscriptions"?(n(),s("div",X,[u.value?(n(),s("div",Y,"Carregando...")):(n(),s("div",Z,[t("table",tt,[e[7]||(e[7]=t("thead",null,[t("tr",null,[t("th",null,"Plano"),t("th",null,"Valor"),t("th",null,"Início"),t("th",null,"Status"),t("th",null,"Ações")])],-1)),t("tbody",null,[b.value.length===0?(n(),s("tr",at,[...e[6]||(e[6]=[t("td",{colspan:"5",class:"empty-state"},"Nenhuma assinatura encontrada",-1)])])):i("",!0),(n(!0),s(p,null,y(b.value,a=>(n(),s("tr",{key:a.id},[t("td",null,o(a.plan),1),t("td",null,o(f(a.amount)),1),t("td",null,o(C(a.started_at)),1),t("td",null,[t("span",{class:_(["badge",`badge-${a.status}`])},o(a.status==="active"?"Ativa":"Cancelada"),3)]),t("td",null,[a.status==="active"?(n(),s("button",{key:0,onClick:D=>$(a.id),class:"btn btn-sm btn-danger",disabled:v.value===a.id},o(v.value===a.id?"Cancelando...":"Cancelar"),9,et)):(n(),s("span",st,"—"))])]))),128))])])]))])):i("",!0)])])])}}},mt=R(nt,[["__scopeId","data-v-0fa3cc6e"]]);export{mt as default};
